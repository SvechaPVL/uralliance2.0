---
description: Создать или обновить конституцию проекта из интерактивных или предоставленных принципиальных входных данных, обеспечивая синхронность всех зависимых шаблонов
---

## Пользовательский Ввод

```text
$ARGUMENTS
```

Вы **ДОЛЖНЫ** учитывать пользовательский ввод перед продолжением (если не пуст).

## Описание

Вы обновляете конституцию проекта в `.specify/memory/constitution.md`. Этот файл является ШАБЛОНОМ, содержащим заполнители токенов в квадратных скобках (напр., `[PROJECT_NAME]`, `[PRINCIPLE_1_NAME]`). Ваша задача: (a) собрать/вывести конкретные значения, (b) заполнить шаблон точно, и (c) распространить любые поправки по зависимым артефактам.

Следуйте этому потоку выполнения:

1. Загрузите существующий шаблон конституции в `.specify/memory/constitution.md`.
   - Идентифицируйте каждый заполнитель токена формы `[ALL_CAPS_IDENTIFIER]`.
     **ВАЖНО**: Пользователю может потребоваться меньше или больше принципов, чем используется в шаблоне. Если указано число, уважайте это - следуйте общему шаблону. Вы обновите документ соответственно.

2. Собрать/вывести значения для заполнителей:
   - Если пользовательский ввод (разговор) предоставляет значение, используйте его.
   - В противном случае выведите из существующего контекста репозитория (README, документы, предыдущие версии конституции, если встроены).
   - Для дат управления: `RATIFICATION_DATE` - это исходная дата принятия (если неизвестна, спросите или отметьте TODO), `LAST_AMENDED_DATE` - это сегодня, если внесены изменения, иначе сохраните предыдущую.
   - `CONSTITUTION_VERSION` должна увеличиваться согласно правилам семантического версионирования:
     - MAJOR: Обратно несовместимые удаления/переопределения управления/принципов.
     - MINOR: Добавлен новый принцип/раздел или материально расширено руководство.
     - PATCH: Уточнения, формулировка, опечатки, несемантические улучшения.
   - Если тип изменения версии неоднозначен, предложите обоснование перед финализацией.

3. Составьте обновленное содержимое конституции:
   - Замените каждый заполнитель конкретным текстом (не остается токенов в скобках, кроме намеренно сохраненных шаблонных слотов, которые проект выбрал не определять еще — явно обоснуйте любые оставшиеся).
   - Сохраняйте иерархию заголовков, и комментарии могут быть удалены после замены, если только они все еще не добавляют уточняющее руководство.
   - Убедитесь, что каждый раздел Принципа: краткая строка имени, параграф (или маркированный список), фиксирующий не подлежащие обсуждению правила, явное обоснование, если не очевидно.
   - Убедитесь, что раздел Управления перечисляет процедуру внесения поправок, политику версионирования и ожидания проверки соответствия.

4. Чеклист распространения согласованности (конвертируйте предыдущий чеклист в активные валидации):
   - Прочитайте `.specify/templates/plan-template.md` и убедитесь, что любая "Проверка Конституции" или правила согласуются с обновленными принципами.
   - Прочитайте `.specify/templates/spec-template.md` для выравнивания области/требований — обновите, если конституция добавляет/удаляет обязательные разделы или ограничения.
   - Прочитайте `.specify/templates/tasks-template.md` и убедитесь, что категоризация задач отражает новые или удаленные типы задач, управляемые принципами (напр., наблюдаемость, версионирование, дисциплина тестирования).
   - Прочитайте каждый файл команды в `.specify/templates/commands/*.md` (включая этот), чтобы проверить, что не осталось устаревших ссылок (специфичных для агента имен вроде CLAUDE только), когда требуется общее руководство.
   - Прочитайте любые документы руководства во время выполнения (напр., `README.md`, `docs/quickstart.md`, или специфичные для агента файлы руководства, если присутствуют). Обновите ссылки на измененные принципы.

5. Создайте Отчет о Влиянии Синхронизации (предварительно добавьте как HTML-комментарий вверху файла конституции после обновления):
   - Изменение версии: старая → новая
   - Список измененных принципов (старый заголовок → новый заголовок, если переименован)
   - Добавленные разделы
   - Удаленные разделы
   - Шаблоны, требующие обновлений (✅ обновлено / ⚠ в ожидании) с путями к файлам
   - Последующие TODO, если какие-либо заполнители намеренно отложены.

6. Валидация перед финальным выводом:
   - Не остается необъясненных токенов в скобках.
   - Строка версии соответствует отчету.
   - Даты в формате ISO YYYY-MM-DD.
   - Принципы декларативны, тестируемы и свободны от расплывчатого языка ("should" → замените на MUST/SHOULD обоснование, где уместно).

7. Запишите завершенную конституцию обратно в `.specify/memory/constitution.md` (перезапись).

8. Выведите финальную сводку пользователю с:
   - Новая версия и обоснование изменения.
   - Любые файлы, отмеченные для ручного последующего действия.
   - Предлагаемое сообщение коммита (напр., `docs: amend constitution to vX.Y.Z (principle additions + governance update)`).

Требования к Форматированию и Стилю:

- Используйте заголовки Markdown точно как в шаблоне (не понижайте/повышайте уровни).
- Переносите длинные строки обоснования для сохранения читаемости (<100 символов идеально), но не навязывайте жестко с неудобными переносами.
- Оставляйте одну пустую строку между разделами.
- Избегайте trailing whitespace.

Если пользователь предоставляет частичные обновления (напр., только одну ревизию принципа), все равно выполните шаги валидации и принятия решения о версии.

Если критическая информация отсутствует (напр., дата ратификации действительно неизвестна), вставьте `TODO(<FIELD_NAME>): explanation` и включите в Отчет о Влиянии Синхронизации под отложенными элементами.

Не создавайте новый шаблон; всегда работайте с существующим файлом `.specify/memory/constitution.md`.
